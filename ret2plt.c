/* Compile: gcc -g -fno-stack-protector -o ret2plt ret2plt.c */
/* Enable ASLR: echo 2 > /proc/sys/kernel/randomize_va_space           */
// https://sploitfun.wordpress.com/2015/05/08/bypassing-aslr-part-i/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

/* Eventhough shell() function isnt invoked directly
  its needed here since 'system@PLT' and 'exit@PLT' stub code
  should be present in executable to successfully exploit it. */
void shell() {
 system("/bin/sh");
 exit(0);
}

int main(int argc, char* argv[]) {
 int i=0;
 char buf[256];
 scanf("%s", buf);
 printf("%s\n",buf);
 return 0;
}
